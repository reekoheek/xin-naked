<style>
naked-select-dir #fileSelector {
  display: none;
}
</style>

<template is="xin-template" for="naked-select-dir">
  <div class="input-button layout horizontal">
    <div class="flex">
      <input type="text" placeholder="Select file..." value="{{value}}">
    </div>
    <div>
      <a class="button solid" on-click="openDialog">Select</a>
    </div>
  </div>
  <input type="file" id="fileSelector" on-change="fileChanged">
</template>

<script>
(function() {
  'use strict';

  xin.Component({
    is: 'naked-select-dir',

    properties: {
      value: {
        type: String,
        notify: true,
      },

      customAttr: {
        type: String,
        observer: 'customAttrChanged',
      }
    },

    openDialog: function() {
      xin.Dom(this.$.fileSelector).fire('click');
    },

    customAttrChanged: function(newVal, oldVal) {
      if (oldVal) {
        oldVal.split(' ').forEach(function(str) {
          this.$.fileSelector.removeAttribute(str);
        }.bind(this));
      }

      if (newVal) {
        newVal.split(' ').forEach(function(str) {
          this.$.fileSelector.setAttribute(str, str);
        }.bind(this));
      }
    },

    fileChanged: function(evt) {
      if (this.$.fileSelector.files.length === 1) {
        this.set('value', this.$.fileSelector.files[0].path);
        console.log(this.value);
      }
    }
  });
})();
</script>